package com.example.exploit.server;

import javax.naming.Context;
import javax.naming.InitialContext;
import java.rmi.registry.LocateRegistry;
import java.util.Properties;

public class RmiServer implements Runnable {
    private String host;
    private String refAddr;
    private int port;

    public RmiServer(String host, String refAddr, int port) {
        this.host = host;
        this.refAddr = refAddr;
        this.port = port;
    }

    @Override
    public void run() {
        try {
            Properties env = new Properties();
            env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.rmi.registry.RegistryContextFactory");
            env.put(Context.PROVIDER_URL, "rmi://" + host + ":" + port);

            InitialContext ctx = new InitialContext(env);
            LocateRegistry.createRegistry(port);

            System.out.println("[RMI] Listening on " + host + ":" + port);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
